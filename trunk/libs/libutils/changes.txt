changed puts to use buffered writing

added vsprintf routine